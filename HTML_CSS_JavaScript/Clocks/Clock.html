<!doctype html>
<html lang="en"><!--C03#007 - Nicola - Clock-->
	<head>
		<meta charset="utf-8">
		<title>Clock</title>
		<style>
			*{
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			body{
				display: flex;
				justify-content: center;
				align-items: center;
				min-height: 100vh;
				background: #2f363e;
				overflow: hidden;
			}
			.clock{
				position: relative;
				width: 280px;
				height: 280px;
				display: flex;
				justify-content: center;
				align-items: center;
				scale: 2.8;
				box-shadow: inset 5px 5px 25px rgba(0,0,0,0.25);
				border-radius: 50%;
				cursor: pointer;
				transition: transform 0.6s ease-in-out;
				user-select: none; 
				-webkit-user-select: none;
				-webkit-tap-highlight-color: transparent;
				outline: none;
			}
			.clock.reflected{
				transform: scaleX(-1);
			}
			.clock::before{
				content: '';
				position: absolute;
				width: 6px;
				height: 6px;
				background: #2f363e;
				z-index: 1000;
				border: 1px solid #fff;
				border-radius: 50%;
			}
			#time{
				position: relative;
				width: 250px;
				height: 250px;
				display: flex;
				justify-content: center;
				align-items: center;
			}
			.circle{
				position: absolute;
				display: flex;
				justify-content: center;
				align-items: center;
			}
			.circle svg{
				transform: rotate(-90deg);
				overflow: visible;
			}
			.circle svg circle{
				fill: transparent;
				stroke-width: 8;
				stroke: var(--clr);
				opacity: 0.25;
				stroke-linecap: round;
			}
			.circle:nth-child(1), #sc{
				width: 240px;
				height: 240px;
			}
			#ss{
				stroke-dasharray: 754;
			} 
			.circle:nth-child(2), #mn{
				width: 200px;
				height: 200px;
			}
			#mm{
				stroke-dasharray: 628;
			}
			.circle:nth-child(3), #hr{
				width: 160px;
				height: 160px;
			}
			#hh{
				stroke-dasharray: 503;
			}
			.dots{
				position: absolute;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				z-index: 10;
			}
			.dots::before{
				content: '';
				position: absolute;
				top: -4px;
				width: 10px;
				height: 10px;
				background: var(--clr);
				border-radius: 50%;
				box-shadow: 0 0 20px var(--clr), 0 0 40px var(--clr);
			}
			.niddles{
				position: absolute;
				display: flex;
				justify-content: center;
				z-index: 5;
			}
			.niddles i{
				position: absolute;
				width: 2px;
				background: var(--clr2);
				height: 50%;
				opacity: 0.5;
				border-radius: 6px;
				transform-origin: bottom;
				transform: scaleY(0.5);
			}
			#time span{
				position: absolute;
				inset: 55px;
				text-align: center;
				color: #999;
				font-family: consolas;
				pointer-events: none;
				transform: rotate(calc(15deg*var(--i)));
			}
			#time span b{
				font-size: 0.25em;
				font-weight: 500;
				display: inline-block;
				transform: rotate(calc(-15deg*var(--i)));
			}
			.clock.reflected #time span b{
				transform: rotate(calc(-15deg*var(--i))) scaleX(-1);
			}
		</style>
	</head>
	<body>
		<div id="clock_el" class="clock" onclick="changeClockDirection()">
			<div id="time">
				<div class="circle" style="--clr:#ff0000">
					<div class="dots" id="sec_dot"></div>
					<svg width="240" height="240"><circle cx="120" cy="120" r="120" id="ss"></circle></svg>
				</div>
				<div class="circle" style="--clr:#0000ff">
					<div class="dots" id="min_dot"></div>
					<svg width="200" height="200"><circle cx="100" cy="100" r="100" id="mm"></circle></svg>
				</div>
				<div class="circle" style="--clr:#ffff00">
					<div class="dots" id="hr_dot"></div>
					<svg width="160" height="160"><circle cx="80" cy="80" r="80" id="hh"></circle></svg>
				</div>
				
				<div class="niddles" style="--clr2:#ff0000;" id="sc"><i></i></div>
				<div class="niddles" style="--clr2:#0000ff;" id="mn"><i></i></div>
				<div class="niddles" style="--clr2:#ffff00;" id="hr"><i></i></div>
			</div>
		</div>

		<script>
			let isReflected = false;
			let lastS = -1;
			const audioCtx = new(window.AudioContext || window.webkitAudioContext)();

			function updateClock(){
				let now = new Date();
				let h = now.getHours(), m = now.getMinutes(), s = now.getSeconds(), ms = now.getMilliseconds();
				if(audioCtx.state === 'running' && s !== lastS){
					playTick();
					lastS = s;
				}
				let sDeg = (s*6);
				let mDeg = (m*6) + (s*0.1);
				let hDeg = (h%24*15) + (m*0.25);
				document.getElementById('sc').style.transform = `rotateZ(${sDeg}deg)`;
				document.getElementById('mn').style.transform = `rotateZ(${mDeg}deg)`;
				document.getElementById('hr').style.transform = `rotateZ(${hDeg}deg)`;
				document.getElementById('sec_dot').style.transform = `rotateZ(${sDeg}deg)`;
				document.getElementById('min_dot').style.transform = `rotateZ(${mDeg}deg)`;
				document.getElementById('hr_dot').style.transform = `rotateZ(${hDeg}deg)`;
				document.getElementById('ss').style.strokeDashoffset = 754 - (754*s)/60;
				document.getElementById('mm').style.strokeDashoffset = 628 - (628*(m + s/60))/60;
				document.getElementById('hh').style.strokeDashoffset = 503 - (503*(h + m/60))/24;
			}

			function playTick(){
				const osc = audioCtx.createOscillator();
				const gain = audioCtx.createGain();
				osc.frequency.setValueAtTime(isReflected ? 150 : 800, audioCtx.currentTime);
				gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
				gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.1);
				osc.connect(gain); gain.connect(audioCtx.destination);
				osc.start(); osc.stop(audioCtx.currentTime + 0.1);
			}

			function drawNumbers(){
				document.querySelectorAll('#time span').forEach(span => span.remove());
				const timeContainer = document.getElementById("time");
				for(let val = 1; val <= 24; val++){
					let span = document.createElement('span');
					span.style.setProperty('--i', val);
					span.innerHTML = `<b>${val}</b>`;
					timeContainer.appendChild(span);
				}
			}

			function changeClockDirection(){
				if(audioCtx.state === 'suspended'){
					audioCtx.resume();
				}
				isReflected = !isReflected;
				document.getElementById('clock_el').classList.toggle('reflected', isReflected);
			}

			drawNumbers();
			setInterval(updateClock, 50);
			updateClock();
		</script>
	</body>
</html>