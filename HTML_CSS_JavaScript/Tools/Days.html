<!DOCTYPE html>
<html lang="en"><!--T03#011 - Roberto - Days-->
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Days</title>
		<style>
			body {
				font-family: sans-serif;
				margin: 20px;
				background-color: #ccccff;
			}
			.container {
				max-width: 450px;
				margin: auto;
				background: white;
				padding: 20px;
				border-radius: 12px;
				box-shadow: 0 4px 8px rgba(0,0,0,0.1);
			}
			h3 {
				color: #5c5cff;
				margin-top: 0;
				text-align: center;
			}
			.section {
				margin-bottom: 25px;
				padding-bottom: 15px;
				border-bottom: 1px solid #eee;
			}
			.section:last-child {
				border-bottom: none;
			}
			label {
				display: block;
				font-weight: bold;
				margin-bottom: 8px;
				font-size: 0.9em;
			}
			.row-group {
				display: flex;
				align-items: center;
				gap: 10px;
				margin-bottom: 8px;
			}
			input[type="text"] {
				flex-grow: 1;
				padding: 8px;
				border: 1px solid #ccc;
				border-radius: 4px;
				min-width: 50px;
			}
			button {
				cursor: pointer;
				padding: 8px 15px;
				background-color: #5c5cff;
				color: white;
				border: none;
				border-radius: 4px;
				font-weight: bold;
				white-space: nowrap;
			}
			button:hover {
				background-color: #4040e6;
			}
			.btn-today {
				background-color: #27ae60;
				min-width: 80px;
			}
			.btn-clear {
				background-color: #e74c3c;
				width: 100%;
				margin-top: 10px;
			}
			.output-field {
				background-color: #f0f0f0;
				font-weight: bold;
				color: #333;
			}
			.btn-action {
				min-width: 45px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h3>Days</h3>

			<div class="section">
				<label>Find the day of the week:</label>
				<div class="row-group">
					<button type="button" class="btn-today" onclick="setTodayAndClear(0)">Today</button>
					<input type="text" id="firstDate" placeholder="gg/mm/aaaa"/>
				</div>
				<div class="row-group">
					<button type="button" class="btn-action" onclick="handleAction('getDayOfTheWeek')"> â†’ </button>
					<input type="text" id="dayOfTheWeek" class="output-field" disabled placeholder="Result">
				</div>
			</div>

			<div class="section">
				<label>Today's date extended:</label>
				<div class="row-group">
					<button type="button" style="width: 100%;" onclick="handleAction('getFullTodayDate')">Show Full Date</button>
				</div>
				<div class="row-group">
					<span style="font-size: 1.2em; padding-left: 10px;">ðŸ“…</span>
					<input type="text" id="todayDate" class="output-field" disabled placeholder="Extended date">
				</div>
			</div>

			<div class="section">
				<label>Difference between two dates:</label>
				<div class="row-group">
					<button type="button" class="btn-today" onclick="setTodayAndClear(1)">Today</button>
					<input type="text" id="secondDate" placeholder="First Date"/>
				</div>
				<div class="row-group">
					<button type="button" class="btn-today" onclick="setTodayAndClear(2)">Today</button>
					<input type="text" id="thirdDate" placeholder="Latter Date"/>
				</div>
				<div class="row-group">
					<button type="button" onclick="handleAction('getDaysOfDifference')">Calculate Difference</button>
					<input type="text" id="daysOfDifference" class="output-field" disabled placeholder="0"/>
				</div>
			</div>

			<button type="button" class="btn-clear" onclick="clearFields()">Clear Fields</button>
		</div>

		<script>
			const DAYS_OF_THE_WEEK = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
			const NUMBER_OF_DAY_OF_EACH_MONTH = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

			function clearFields(){
				const ids = ["firstDate", "dayOfTheWeek", "todayDate", "secondDate", "thirdDate", "daysOfDifference"];
				ids.forEach(id => document.getElementById(id).value = "");
			}

			function handleAction(actionName){
				const v1 = document.getElementById("firstDate").value;
				const v2 = document.getElementById("secondDate").value;
				const v3 = document.getElementById("thirdDate").value;

				clearFields();

				if(actionName === 'getDayOfTheWeek'){
					document.getElementById("firstDate").value = v1;
				}
				if(actionName === 'getDaysOfDifference'){
					document.getElementById("secondDate").value = v2;
					document.getElementById("thirdDate").value = v3;
				}

				window[actionName]();
			}

			function setTodayAndClear(field){
				const today = getFormattedToday();
				let v2 = document.getElementById("secondDate").value;
				let v3 = document.getElementById("thirdDate").value;

				clearFields();

				if(field === 0){
					document.getElementById("firstDate").value = today;
				}
				if(field === 1){
					document.getElementById("secondDate").value = today;
					document.getElementById("thirdDate").value = v3;
				}
				if(field === 2){
					document.getElementById("secondDate").value = v2;
					document.getElementById("thirdDate").value = today;
				}
			}

			function getFormattedToday(){
				const d = new Date();
				return d.getDate() + "/" +(d.getMonth() + 1) + "/" + d.getFullYear();
			}

			function isLeapYear(year){
				return((year >= 1582) && ((year%4 === 0 && year%100 !== 0) || (year%400 === 0)));
			}

			function parseDateParts(dateStr){
				const parts = dateStr.split("/");
				if(parts.length !== 3){
					return null;
				}
				return {d: parseInt(parts[0]), m: parseInt(parts[1]), y: parseInt(parts[2]) };
			}

			function isCorrectDate(dateStr){
				const p = parseDateParts(dateStr);
				if(!p || isNaN(p.d) || isNaN(p.m) || isNaN(p.y)){
					return false;
				}
				if(p.y < 1 || p.y > 3999){
					return false;
				}
				if(p.m < 1 || p.m > 12){
					return false;
				}
				let maxDays = NUMBER_OF_DAY_OF_EACH_MONTH[p.m - 1];
				maxDays += (p.m === 2 && isLeapYear(p.y)) ? 1 : 0;
				if(p.d < 1 || p.d > maxDays){
					return false;
				}
				if(p.y === 1582 && p.m === 10 && p.d > 4 && p.d < 15){
					return false;
				}
				return true;
			}

			function getTotalDays(dateStr){
				if(!isCorrectDate(dateStr)){
					return -1;
				}
				const p = parseDateParts(dateStr);
				let days = p.d;
				if(p.y === 1582 && p.m === 10 && p.d > 14){
					days -= 10;
				}
				for(let i = 1; i < p.y; i++){
					days += (i === 1582) ? 355 :(365 +(isLeapYear(i) ? 1 : 0));
				}
				for(let i = 1; i < p.m; i++){
					days += ((p.y === 1582 && i === 10) ? 21 : (NUMBER_OF_DAY_OF_EACH_MONTH[i - 1] + ((i === 2 && isLeapYear(p.y)) ? 1 : 0)));
				}
				return days;
			}

			function getDayOfTheWeek(){
				const val = document.getElementById("firstDate").value;
				const total = getTotalDays(val);
				document.getElementById("dayOfTheWeek").value =(total < 0) ? "Wrong date!" : DAYS_OF_THE_WEEK[(total + 1)%7];
			}

			function getFullTodayDate(){
				const date = getFormattedToday();
				const total = getTotalDays(date);
				document.getElementById("todayDate").value = (total < 0) ? "Error" : DAYS_OF_THE_WEEK[(total + 1)%7] + " " + date;
			}

			function getDaysOfDifference(){
				const days1 = getTotalDays(document.getElementById("secondDate").value);
				const days2 = getTotalDays(document.getElementById("thirdDate").value);
				document.getElementById("daysOfDifference").value = (days1 >= 0 && days2 >= 0) ? Math.abs(days1 - days2) : "Input Error!";
			}
		</script>
	</body>
</html>