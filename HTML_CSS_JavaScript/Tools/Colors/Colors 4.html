<!DOCTYPE html>
<html lang="en"><!--L04#018 - Mario - Colors-->
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Colors</title>
		<style>
			body {
				transition: background-color 0.3s, color 0.3s; 
				text-align: center; 
				font-family: 'Segoe UI', Arial, sans-serif; 
				padding: 10px;
				margin: 0;
				min-height: 100vh;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}
			#headerContainer {
				padding: 15px;
				margin-bottom: 20px;
				border-radius: 10px;
				transition: background 0.3s;
			}
			.control-panel {
				background: rgba(255, 255, 255, 0.2);
				backdrop-filter: blur(5px);
				padding: 15px;
				border-radius: 15px;
				border: 1px solid rgba(255,255,255,0.3);
				width: 100%;
				max-width: 400px;
				box-sizing: border-box;
			}
			.row {
				display: flex;
				justify-content: center;
				gap: 6px;
				margin-bottom: 10px;
			}
			.footer-row {
				display: flex;
				flex-wrap: wrap;
				justify-content: center;
				gap: 8px;
				margin-top: 15px;
			}
			button {
				cursor: pointer; 
				margin: 0;
				border: 2px solid rgba(0,0,0,0.1); 
				border-radius: 8px;
				font-weight: bold;
				transition: all 0.2s;
				height: 45px;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			button:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0,0,0,0.2);
			}
			button:active {
				transform: translateY(0);
			}
			.num-label {
				font-size: 1.1em;
				color: inherit;
			}
			output {
				font-family: monospace;
			}
			#mainLabel {
				font-size: 2.5em; 
				font-weight: 900;
				font-family: monospace;
				display: inline-block;
				vertical-align: middle;
			}
			#valueHexCode {
				font-size: 1em;
				font-family: monospace;
				letter-spacing: 0px;
				margin-left: 5px;
			}
		</style>
	</head>

	<body>
		<div id="headerContainer">
			<span id="mainLabel">HEX: <output id="valueHexCode">#FFFFFF</output></span>
		</div>
		<br>
		<div id="mainPanel" class="control-panel"></div>
	</body>

	<script>
		const COMPONENTS = ['00', '3F', '7F', 'BF', 'FF'];
		const BUTTONS_COLORS = ['#FF4136', '#2ECC40', '#0074D9'];
		const BUTTON_WIDTH_1 = 65;
		const BUTTON_WIDTH_2 = 165;
		const BUTTON_WIDTH_3 = 340;
		
		let actualComponents = [4, 4, 4];

		function fillBody(){
			const panel = document.getElementById("mainPanel");

			for(let i = 0; i < 3; i++){
				let row = document.createElement("div");
				row.className = "row";
				for(let j = 0; j < 5; j++){
					let btn = document.createElement("button");
					btn.id = i + "-" + j;
					btn.style.width = "18%"; 
					btn.style.maxWidth = "60px";
					btn.innerHTML = `<span class="num-label">${j}</span>`;
					btn.onclick =() => setBackgroundColor(i, j);
					row.appendChild(btn);
				}
				panel.appendChild(row);
			}

			const footer = document.createElement("div");
			footer.className = "footer-row";

			const btnConfigs = [
				{text: "BLACK", cmd: setBlack, flex: "0 1 45%" },
				{text: "WHITE", cmd: setWhite, flex: "0 1 45%" },
				{text: "DARKER", cmd: darker, flex: "0 1 45%" },
				{text: "BRIGHTER", cmd: brighter, flex: "0 1 45%" },
				{text: "RANDOM", cmd: setRandomBackgroundColor, flex: "0 1 92%" }
			];

			btnConfigs.forEach((cfg) => {
				let b = document.createElement("button");
				b.style.flex = cfg.flex;
				b.style.minWidth = "120px";
				b.textContent = cfg.text;
				b.onclick = cfg.cmd;
				footer.appendChild(b);
			});

			panel.appendChild(footer);
			updateInterface();
		}

		function setBackgroundColor(channel, index){
			actualComponents[channel] = index;
			updateInterface();
		}

		function updateInterface(){
			const r = parseInt(COMPONENTS[actualComponents[0]], 16);
			const g = parseInt(COMPONENTS[actualComponents[1]], 16);
			const b = parseInt(COMPONENTS[actualComponents[2]], 16);
			const hex = "#" + COMPONENTS[actualComponents[0]] + COMPONENTS[actualComponents[1]] + COMPONENTS[actualComponents[2]];
			document.body.style.backgroundColor = hex;
			document.getElementById("valueHexCode").textContent = hex;

			const brightness =(r*299 + g*587 + b*114)/1000;
			const textColor = brightness > 125 ? "black" : "white";
			const labelBg = brightness > 125 ? "rgba(255,255,0,0.8)" : "rgba(255,255,0,1)";

			document.body.style.color = textColor;
			document.getElementById("headerContainer").style.background = brightness > 125 ? "rgba(255,255,255,0.3)" : "rgba(0,0,0,0.3)";

			for(let i = 0; i < 3; i++){
				for(let j = 0; j < 5; j++){
					let btn = document.getElementById(i + "-" + j);
					if(actualComponents[i] === j){
						btn.style.backgroundColor = "#FFFF00";
						btn.style.color = "black";
						btn.style.borderColor = "black";
					}else{
						btn.style.backgroundColor = BUTTONS_COLORS[i];
						btn.style.color = "white";
						btn.style.borderColor = "transparent";
					}
				}
			}
		}

		function setRandomBackgroundColor(){
			actualComponents = actualComponents.map(() => Math.floor(Math.random()*5));
			updateInterface(); 
		}

		function playErrorSound(){
			try {
				const context = new (window.AudioContext || window.webkitAudioContext)();
				const oscillator = context.createOscillator();
				const gain = context.createGain();
				oscillator.type = 'sine';
				oscillator.frequency.setValueAtTime(150, context.currentTime);
				gain.gain.setValueAtTime(0.1, context.currentTime);
				gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.2);
				oscillator.connect(gain);
				gain.connect(context.destination);
				oscillator.start();
				oscillator.stop(context.currentTime + 0.2);
			} catch (e){
				console.log("Audio not supported or blocked by browser");
			}
		}

		function flashError(){
			const label = document.getElementById("mainLabel");
			label.style.transition = "0.1s";
			label.style.color = "red";
			setTimeout(() => {
				label.style.color = "";
			}, 200);
			playErrorSound();
		}

		function brighter(){
			const canMove = actualComponents.every(v => v < 4);
			if(canMove){
				actualComponents = actualComponents.map(v => v + 1);
				updateInterface();
			} else {
				flashError();
			}
		}

		function darker(){
			const canMove = actualComponents.every(v => v > 0);
			if(canMove){
				actualComponents = actualComponents.map(v => v - 1);
				updateInterface();
			} else {
				flashError();
			}
		}

		function setBlack(){
			actualComponents = [0,0,0];
			updateInterface();
		}

		function setWhite(){
			actualComponents = [4,4,4];
			updateInterface();
		}

		fillBody();
	</script>
</html>